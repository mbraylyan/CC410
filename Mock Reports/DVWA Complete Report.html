<html>
<head>
<title>Scan Remediation Report #1</title>
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src data:; style-src 'nonce-YWJlOGQyNmMtNjAwNy00NWQzLWI1NTItMmU0ODFhZWEwMjE5'; base-uri 'none';">
<style nonce="YWJlOGQyNmMtNjAwNy00NWQzLWI1NTItMmU0ODFhZWEwMjE5">
body {
font-family: 'Roboto', Helvetica, Arial, sans-serif;
color: #4d5155;
-webkit-font-smoothing: antialiased;
font-size: 14px;
background-color: #F7F9FD;
}

.report {
width: 712px;
margin: 0 auto;
position: relative;
background-color: white;
border-left: 60px solid white;
border-right: 60px solid white;
border-top: 20px solid white;
border-bottom: 20px solid white;
}

.header {
height: 150px;
display: flex;
justify-content: space-between;
align-items: center;
border-bottom: 1px solid #0094FF;
}

.header h1 {
font-size: 44px;
color: #333332;
}

.header h2 {
font-size: 26px;
color: #333332;
}

.line {
border-left: 16px solid #0094FF;
height: 150px;
width: 24px;
position: absolute;
left: -40px;
float: left;
}

.section {
width: 100%;
margin-top: 50px;
}

.section.no-margin {
margin-top: 10px;
}

.label {
white-space: nowrap;
color: #8c8d8e;
margin-top: 30px;
}

.label:first-child {
margin-top: 0px;
}

.divider {
border-bottom: 1px solid #0094FF;
}

.title h1 {
color: #ffffff;
padding: 10px 15px;
margin: 0;
font-size: 1.8em;
}

.title img {
display: inline
}

table {
line-height: 20px;
}

h1 {
color: #333332;
font-size: 24px;
font-weight: bold;
margin-bottom: 20px;
}

h2 {
color: #333332;
font-size: 18px;
font-weight: normal;
margin-top: 0;
margin-bottom: 20px;
}

a {
color: #ff6633;
text-decoration: none;
}

.column-table .value.warning {
color: #ff6633;
font-size: 12px;
}

.column-table .value.error {
color: #f32a4c;
font-size: 12px;
}

.info-table {
margin-right: 50px;
}

.info-table td {
padding: 3px 3px 3px 0;
border-bottom: 1px solid #ebf0f2;
vertical-align: top;
overflow-wrap: break-word;
word-break: break-all;
}

.info-table td + td {
margin: 20px
}

.info-table .name {
width: 200px;
white-space: nowrap;
color: #8c8d8e;
}

.info-table .value {
text-align: right;
}

.issue-table {
border-collapse: collapse;
margin-top: 30px;
}

.issue-table thead th {
white-space: nowrap;
}

.issue-table tr {
border: 0;
border-bottom: 1px solid #8c8d8e;
}

.issue-table tr.issue-type-row {
font-weight: bold;
border-bottom: 0;
}

.issue-table tr th {
text-align: left;
padding-bottom: 8px;
padding-right: 8px;
width: 98%;
}

.issue-table tr .issue-path {
word-wrap: break-word;
max-width: 700px;
text-align: left;
padding-bottom: 8px;
padding-right: 8px;
width: 98%;
}

.issue-table td {
padding-right: 8px;
}

.issue-table td.nowrap {
white-space: nowrap;
}

.column-table {
width: 100%;
}

.column-table > tbody > tr > td {
width: 50%;
vertical-align: top;
}

.column-table > tbody > tr > td > .value {
display: flex;
}

.user-icon {
padding-right: 6px;
}

.recorded-icon {
padding-right: 10px;
}

.url {
word-break: break-all;
}

.section.details h1 {
margin-bottom: 30px;
}

.section.details h2 {
font-size: 14px;
font-weight: bold;
color: #4d5155;
margin: 0;
}

.section.details h3 {
font-size: 14px;
font-weight: normal;
color: #8c8d8e;
margin-top: 30px;
margin-bottom: 20px;
}

.center {
text-align: center;
}

.no-bullets ul {
list-style: none;
padding-left: 0;
}

.issue-container {
margin-bottom: 30px;
}

@media print {
body {
color: #000000;
position: relative;
}

.report {
width: calc(100% - 80px);
}

h1, h2, a {
color: #000000;
}

.no-print {
display: none;
}
}
.request-response {
overflow: auto;
border-radius: 7px;
border: 1px solid #dce3e5;
padding: 8px;
color: #000000;
}

.request-response .highlight {
background-color: rgba(255, 102, 51, 0.4);
}

.request-response, .code, pre {
font-family: "Courier New", Courier, monospace;
line-height: 16px;
word-break: break-all;
white-space: pre-wrap;
}

.request-response .snip {
margin-top: 20px;
margin-bottom: 20px;
position: relative;
border-top: 1px dashed #cbd0d1;
}

.request-response .snip > span {
position: absolute;
top: -13px;
display: inline-block;
width: 100%;
text-align: center;
}

.request-response .snip > span > span {
color: #8c8d8e;
padding: 0 8px;
background-color: #ffffff;
}
</style>
</head>
<body>

<div class="report">
<div class="line"></div>

<div class="header">
<div class="text">
<h1>Scan Remediation</h1>
<h2>Report</h2>
</div>
<img src='data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNzYgODkiIHZpZXdCb3g9IjAgMCAyNzYgODkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTE0OS42IDEyLjJjMi45IDAgNS40IDEgNyAyLjUgMi44IDIuOCAzLjIgNy40IDMuMiAxMi4xcy0uNSA5LjMtMy4yIDEyLjJjLTEuNiAxLjYtNCAyLjUtNyAyLjUtMy4xIDAtNS40LS43LTcuNS0zLjN2MTQuNWgtNS44di00MC4xaDUuN3YzLjFjMi4yLTIuNyA0LjYtMy41IDcuNi0zLjV6bS01Ny4zLjR2MTcuNGMwIDQuNSAyLjUgNi40IDUuOCA2LjQgMy4yIDAgNS45LTIgNS45LTYuNHYtMTcuNGg1Ljh2MjguN2gtNS42di0yLjljLTIgMi4xLTQuOCAzLjMtNy42IDMuMi0yLjYuMS01LjItLjktNy4xLTIuNi0yLjItMi4xLTIuOS00LjktMi45LTguMXYtMTguM3ptMTEyLjMgMHYxNy40YzAgNC41IDIuNSA2LjQgNS44IDYuNCAzLjIgMCA1LjktMiA1LjktNi40di0xNy40aDUuOHYyOC43aC01LjZ2LTIuOWMtMiAyLjEtNC44IDMuMy03LjYgMy4yLTIuNi4xLTUuMi0uOS03LjEtMi42LTIuMi0yLjEtMi45LTQuOS0yLjktOC4xdi0xOC4zem0tMjIuNy0xMmM1LjQgMCA5LjEgMS40IDEyLjUgNC42bC0zLjkgMy44Yy0yLjUtMi40LTUuNC0zLjEtOC45LTMuMS00LjggMC03LjMgMi42LTcuMyA2LjMtLjEgMS40LjQgMi44IDEuNSAzLjcgMSAuOSAyLjIgMS41IDQuNCAxLjhsNC44LjdjMy43LjYgNS43IDEuNCA3LjUgMyAyLjIgMiAzLjMgNC43IDMuMyA4LjMgMCA3LjQtNiAxMS44LTE0LjUgMTEuOC02LjEgMC0xMC40LTEuNC0xNC4zLTUuM2w0LTRjMi45IDIuOSA2LjMgMy45IDEwLjQgMy45IDUuMyAwIDguMy0yLjMgOC4zLTYuMiAwLTEuOC0uNS0zLjItMS42LTQuMi0xLS45LTIuNC0xLjQtNC40LTEuN2wtNC44LS43Yy0zLjMtLjUtNS44LTEuNS03LjYtMy4yLTItMS44LTMtNC40LTMtNy44LjEtNi45IDUuMi0xMS43IDEzLjYtMTEuN3ptODEuMiAxMS42YzcuNyAwIDEyLjIgNS41IDEyLjIgMTMuOXYyLjRoLTE4LjZjMCA1IDIuNSA4IDcuMyA4IDMuMiAwIDQuOS0uOSA3LTIuOWwzLjcgMy41Yy0zIDIuOS01LjcgNC41LTEwLjggNC41LTcuMiAwLTEyLjktMy44LTEyLjktMTQuNy0uMS05LjQgNC43LTE0LjcgMTIuMS0xNC43em0tMzAuNC40djI4LjdoLTUuOHYtMjguN3ptLTE2Mi42LTExLjZjNy41IDAgMTIuMiA0LjIgMTIuMiAxMSAuMSAzLjctMi4xIDcuMS01LjQgOC41IDMuMSAxLjIgNi4xIDQuMiA2LjEgOS4zIDAgNy40LTUgMTEuNC0xMi4yIDExLjRoLTE2LjR2LTQwLjJ6bTY0LjYgMTMuOS00LjQgNC40Yy0xLjMtMS4zLTIuMy0xLjktNC4zLTEuOS0zLjEgMC01LjcgMi41LTUuNyA2LjV2MTcuNGgtNS44di0yOC43aDUuN3YzLjFjMS41LTIgNC40LTMuNCA3LjYtMy40IDIuNy0uMiA1LjIuOCA2LjkgMi42em0xMDkuNS0xMC41djguMmg1LjZ2NC40aC01LjZ2MTZjMCAyLjEgMSAzLjMgMy4yIDMuM2gyLjR2NC45aC0zLjVjLTUuNCAwLTcuOS0zLjgtNy45LTh2LTE2LjJoLTMuM3YtNC40aDMuM3YtOC4yem0tOTYuMSAxM2MtNS4zIDAtNiA0LjQtNiA5LjVzLjcgOS42IDYgOS42IDUuOS00LjUgNS45LTkuNi0uNi05LjUtNS45LTkuNXptLTc3LjkgNi4xaC05LjZ2MTIuM2g5LjZjNC4yIDAgNi42LTIuNiA2LjYtNi4ycy0yLjQtNi4xLTYuNi02LjF6bTE5Mi44LTYuNWMtMi40IDAtNC43IDEuNC01LjcgMy42LS41IDEuMi0uOCAyLjUtLjcgMy45aDEyLjljMC0xLjMtLjMtMi43LS44LTMuOS0xLTIuMS0zLjItMy42LTUuNy0zLjZ6bS0xOTMuNC0xMC41aC05LjF2MTEuNWg5LjFjMy45IDAgNi42LTIgNi42LTUuOCAwLTMuNy0yLjctNS43LTYuNi01Ljd6bTE2My4zLTUuN3Y2LjFoLTYuMXYtNi4xeiIgZmlsbD0iIzAwMDAyMyIvPjxwYXRoIGQ9Im00MS42LjhoLTQwLjd2NDAuN2g0MC43eiIgZmlsbD0iIzAwOTRmZiIvPjxwYXRoIGQ9Im0yMi44IDM1LjhoLTMuMnYtNC43bDQuMy01LjJoLTQuM3YtNi40aC03LjZsNy43LTkuNXYtMy42aDMuMnY0LjdsLTQuMyA1LjJoNC4zdjYuNGg3LjdsLTcuNyA5LjV2My42eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Im0xMjQuMSA2Ni40YzEuMy0uMSAyLjcuNCAzLjcgMS4zIDEuNSAxLjUgMS45IDQgMS45IDYuM3MtLjQgNC44LTEuOSA2LjNjLTEgLjktMi4zIDEuNC0zLjcgMS4zLTEuNy4xLTMuNC0uNy00LjQtMi4xdjloLTEuNnYtMjJoMS42djEuOWMxLTEuNCAyLjctMi4yIDQuNC0yem0tMjYuMSAwYzMuNyAwIDYgMi43IDYgNy4zdi43aC0xMC40YzAgMy44IDEuNyA1LjkgNC45IDUuOSAxLjYuMSAzLjEtLjYgNC4xLTEuOGwxLjIuOWMtMS40IDEuNS0zLjMgMi40LTUuNCAyLjMtNC4xIDAtNi40LTIuNi02LjQtNy42IDAtNC45IDIuMi03LjcgNi03Ljd6bTcwLjEgMGMzLjggMCA2IDIuNyA2IDcuM3YuN2gtMTAuNGMwIDMuOCAxLjcgNS45IDQuOSA1LjkgMS42LjEgMy4xLS42IDQuMS0xLjhsMS4yLjljLTEuNCAxLjUtMy4zIDIuNC01LjQgMi4zLTQuMSAwLTYuNC0yLjYtNi40LTcuNiAwLTQuOSAyLjItNy43IDYtNy43em00Mi4xLTd2MjJoLTEuNnYtMS45Yy0xIDEuNC0yLjcgMi4yLTQuNCAyLjEtMS4zLjEtMi43LS40LTMuNy0xLjMtMS41LTEuNS0xLjktNC0xLjktNi4zIDAtMi40LjQtNC44IDEuOS02LjMgMS0uOSAyLjMtMS40IDMuNy0xLjMgMS43LS4xIDMuNC43IDQuNCAyLjF2LTloMS42em0tNTAuOSA4LjUtMS4xIDEuMWMtMS4yLS45LTIuNy0xLjMtNC4yLTEuMy0yLjUgMC0zLjggMS0zLjggMi45IDAgMS42LjkgMi4zIDMgMi41bDIuNC4yYzIuNS4yIDQuNCAxIDQuNCAzLjkgMCAyLjctMi4zIDQuNC02IDQuNC0yLjYgMC00LjUtLjctNi4xLTIuMWwxLjEtMS4xYzEuMyAxLjMgMy4xIDEuOSA0LjkgMS44IDIuOSAwIDQuNS0xIDQuNS0zIDAtMS42LS45LTIuMy0yLjktMi41bC0yLjUtLjJjLTMtLjItNC41LTEuNS00LjUtMy45IDAtMi42IDIuMS00LjIgNS40LTQuMiAyLS4xIDMuOS41IDUuNCAxLjV6bTgyLjcuMWMxLjYgMS42IDEuOSAzLjkgMS45IDZzLS4zIDQuNC0xLjkgNmMtMi4zIDIuMi02IDIuMi04LjMgMC0xLjYtMS42LTEuOS0zLjktMS45LTZzLjMtNC40IDEuOS02YzIuMy0yLjIgNS45LTIuMiA4LjMgMHptLTEyNS42LS4yLTEuMSAxLjFjLS43LS44LTEuNy0xLjItMi44LTEuMi0yLjYgMC00IDIuMS00IDQuNXY5LjJoLTEuNnYtMTQuOGgxLjZ2MmMxLTEuNCAyLjYtMi4yIDQuNC0yLjIgMS4yLS4xIDIuNS40IDMuNSAxLjR6bTI1LjkgMC0xLjEgMS4xYy0uNy0uOC0xLjctMS4yLTIuOC0xLjItMi42IDAtNCAyLjEtNCA0LjV2OS4yaC0xLjZ2LTE0LjhoMS42djJjMS0xLjQgMi42LTIuMiA0LjQtMi4yIDEuMy0uMSAyLjYuNCAzLjUgMS40em0xMTIuNC0xLjRjMi4zLjggMy44IDMuMSAzLjYgNS41djkuNWgtMS42di05LjNjMC0yLjktMS40LTQuNS00LjEtNC41cy00LjIgMS42LTQuMiA0LjV2OS4zaC0xLjZ2LTE0LjloMS42djEuOGMxLjUtMS45IDQtMi43IDYuMy0xLjl6bS01Ny43LTd2MS41aC0xMS43djguN2gxMHYxLjVoLTEwdjguOWgxMS43djEuNWgtMTMuNHYtMjJoMTMuNHptMjQuNCAyLjR2NC44aDMuNHYxLjJoLTMuNHY5LjljMCAxLjYuNyAyLjUgMi4zIDIuNWgxLjF2MS40aC0xLjRjLTIuNCAwLTMuNi0xLjYtMy42LTMuOXYtOS45aC0ydi0xLjJoMnYtNC44em0tMTQyLjkgNC43YzIuMy44IDMuOCAzLjEgMy42IDUuNXY5LjVoLTEuNnYtOS4zYzAtMi45LTEuNC00LjUtNC4xLTQuNXMtNC4yIDEuNi00LjIgNC41djkuM2gtMS42di0xNWgxLjZ2MS44YzEuNS0xLjkgNC0yLjcgNi4zLTEuOHptLTEwLjYtNy4xdjEuNWgtMTEuN3Y4LjdoMTB2MS41aC0xMHY4LjloMTEuN3YxLjVoLTEzLjR2LTIyaDEzLjR6bTE0Ny42IDcuMXYxNC45aC0xLjZ2LTE0Ljl6bS0xMjguMS00Ljd2NC44aDMuNHYxLjJoLTMuNHY5LjljMCAxLjYuNyAyLjUgMi4zIDIuNWgxLjF2MS40aC0xLjRjLTIuNCAwLTMuNi0xLjYtMy42LTMuOXYtOS45aC0ydi0xLjJoMnYtNC44em01OC4zIDQuN3YxNC45aC0xLjZ2LTE0Ljl6bTgzLjEgMHYxNC45aC0xLjZ2LTE0Ljl6bTUuOSAyLjVjLTEuMiAxLjItMS4zIDMuMS0xLjMgNC44di4yYzAgMS43LjEgMy43IDEuMyA1IDEuNyAxLjcgNC41IDEuNyA2LjIgMCAxLjItMS4yIDEuMy0zLjEgMS4zLTQuOHYtLjJjMC0xLjctLjEtMy43LTEuMy01LTEuNy0xLjctNC41LTEuNy02LjIgMHptLTMwLjMtMS4yYy0zLjcgMC00LjIgMy4yLTQuMiA2LjNzLjYgNi4zIDQuMiA2LjNjMy43IDAgNC4yLTMuMiA0LjItNi4zcy0uNi02LjMtNC4yLTYuM3ptLTgwLjUgMGMtMy43IDAtNC4yIDMuMi00LjIgNi4zcy42IDYuMyA0LjIgNi4zIDQuMi0zIDQuMi02LjF2LS4yYzAtMy4yLS41LTYuMy00LjItNi4zem00NC4yIDBjLTEuNyAwLTMuMiAxLTMuOSAyLjUtLjQuOS0uNiAxLjktLjUgMi44aDguOGMwLTEtLjItMS45LS41LTIuOC0uNy0xLjYtMi4yLTIuNi0zLjktMi41em0tNzAuMSAwYy0xLjcgMC0zLjIgMS0zLjkgMi41LS40LjktLjYgMS45LS41IDIuOGg4LjhjMC0xLS4yLTEuOS0uNS0yLjgtLjctMS42LTIuMi0yLjYtMy45LTIuNXptNDcuOS04LjR2MmgtMnYtMnptNjkuOCAwdjJoLTJ2LTJ6bTEzLjMgMHYyaC0ydi0yeiIgZmlsbD0iIzAwOTRmZiIvPjwvc3ZnPg==' width="210" height="60"/>
</div>

<div class="section no-margin">
<span class="label">Generated by Burp Suite Enterprise Edition | 2023-11-17 3:27 PM</span>
</div>

<div class="section">
<table class="column-table">
<tbody>
<tr>
<td>
<div class="label">Site name:</div>
<div class="value">http://localhost/DVWA</div>
<div class="label">Scanned:</div>
<table>
<tbody>
<tr>
<td>
<div class="value">Start:</div>
</td>
<td>
<div class="value">2023-11-16 6:16 PM</div>
</td>
</tr>
<tr>
<td>
<div class="value">End:</div>
</td>
<td>
<div class="value">2023-11-16 6:31 PM</div>
</td>
</tr>
</tbody>
</table>
<div class="label">Duration:</div>
<div class="value">15m 0s</div>
<div class="label">Status:</div>
<div class="value">Completed</div>
</td>
<td>
<div class="label">Start URLs:</div>
<div class="value url">http://localhost/DVWA</div>

<div class="label">Application logins:</div>
<div class="value"> <img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4IgogICAgIHZpZXdCb3g9IjAgMCAxNyAxNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTcgMTc7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7ZmlsbDojMzMzMzMyO30KPC9zdHlsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTEzLjEsMTEuNGMtMC4xLTEuNi0xLTMuMS0yLjMtMy45YzAuMy0wLjQsMC41LTEsMC41LTEuNWMwLTEuNS0xLjItMi44LTIuOC0yLjhTNS43LDQuNSw1LjcsNgoJYzAsMC42LDAuMiwxLjEsMC41LDEuNWMtMS40LDAuOC0yLjMsMi4zLTIuMyw0djEuNWwwLDAuMWMwLDAuMywwLjMsMC41LDAuNiwwLjVjMC4zLDAsMC42LTAuMywwLjYtMC42di0xLjVsMC0wLjEKCUM1LjIsMTAuMSw2LDksNy4yLDguNWMwLDAsMCwwLDAsMGwwLjEsMGMwLDAtMC4xLDAtMC4xLDAuMUM3LjYsOC43LDgsOC44LDguNSw4LjhjMC41LDAsMC45LTAuMSwxLjMtMC4zYzEuMiwwLjUsMi4xLDEuOCwyLjEsMy4xCgl2MS41bDAsMC4xYzAsMC4zLDAuMywwLjUsMC42LDAuNWMwLjMsMCwwLjYtMC4zLDAuNi0wLjZ2LTEuNUwxMy4xLDExLjR6IE04LjUsNy42QzcuNiw3LjYsNyw2LjksNyw2czAuNy0xLjUsMS41LTEuNVMxMCw1LjIsMTAsNgoJUzkuNCw3LjYsOC41LDcuNnoiLz4KPC9zdmc+' width="22" height="22" class="user-icon"/> admin</div>

<div class="label">Reference:</div>

<div class="value">
#1
</div>
</td>
</tr>
</tbody>
</table>
</div>

<div class="section">
<table class="column-table">
<tbody>
<tr>
<td>
<h2>Issues by severity</h2>
<table class="info-table">
<tbody>
<tr>
<td class="name">High:</td>
<td class="value">5</td>
</tr>
<tr>
<td class="name">Medium:</td>
<td class="value">5</td>
</tr>
<tr>
<td class="name">Low:</td>
<td class="value">2</td>
</tr>
<tr>
<td class="name">Information:</td>
<td class="value">14</td>
</tr>
<tr>
<td class="name">Total issues found:</td>
<td class="value">26</td>
</tr>
</tbody>
</table>
</td>
<td>
<h2>Scan statistics</h2>
<table class="info-table">
<tbody>
<tr>
<td class="name">Total scanned URLs:</td>
<td class="value">64</td>
</tr>
<tr>
<td class="name">URLs with errors:</td>
<td class="value">1</td>
</tr>
<tr>
<td class="name">Requests made:</td>
<td class="value">8149</td>
</tr>
<tr>
<td class="name">Network errors:</td>
<td class="value">5</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>

<div class="section divider"></div>

<div class="section">
<h1>Issues found on http://localhost</h1>

<table class='issue-table'>
<thead>
<tr>
<th>URLs By issue type</th>
<th>Severity</th>
<th>Confidence</th>
<th class="no-print">More detail</th>
</tr>
</thead>
<tbody>
<tr class="issue-type-row">
<td colspan="4">Cleartext submission of password [4]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/login.php
</td>
<td>High</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#6662265378201060352">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/brute/
</td>
<td>High</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#8273319290171446272">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/captcha/
</td>
<td>High</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#3199837816772665344">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/csrf/
</td>
<td>High</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#9219153304335241216">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Cross-site scripting (DOM-based) [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/xss_d/
</td>
<td>High</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#6632941044297651200">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Cross-site scripting (reflected) [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/captcha/
</td>
<td>Medium</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#2639630762444047360">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Session token in URL [4]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/csrf/
</td>
<td>Medium</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#3436743729126238208">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/sqli/
</td>
<td>Medium</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#1428459683784560640">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/sqli_blind/
</td>
<td>Medium</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#7004884733245221888">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/xss_r/
</td>
<td>Medium</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#4462581235335974912">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Unencrypted communications [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/
</td>
<td>Low</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#4495901298508497920">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Password submitted using GET method [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/csrf/
</td>
<td>Low</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#5175234955310882816">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Input returned in response (reflected) [2]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/phpinfo.php
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#530462010373129216">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/captcha/
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#8583106390470191104">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Cross-domain Referer leakage [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/instructions.php
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#2553727121472761856">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Cross-domain script include [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/captcha/
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#6513416475085334528">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Cookie without HttpOnly flag set [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/security.php
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#9061096486082190336">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">File upload functionality [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/vulnerabilities/upload/
</td>
<td>Info</td>
<td class="nowrap">Certain</td>
<td class="nowrap center no-print"><a href="#698793763940194304">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Path-relative style sheet import [5]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#844732300998313984">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/about.php
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#1579841131381371904">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/index.php
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#4802661808791532544">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/instructions.php
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#9097519369040133120">&gt;&gt;</a></td>
</tr><tr>
<td class="issue-path issue-link">
/DVWA/login.php
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#7585101238261731328">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Frameable response (potential Clickjacking) [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA
</td>
<td>Info</td>
<td class="nowrap">Firm</td>
<td class="nowrap center no-print"><a href="#3194368389396474880">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">Spoofable client IP address [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/phpinfo.php
</td>
<td>Info</td>
<td class="nowrap">Tentative</td>
<td class="nowrap center no-print"><a href="#1617911168488937472">&gt;&gt;</a></td>
</tr><tr class="issue-type-row">
<td colspan="4">User agent-dependent response [1]</td>
</tr>

<tr>
<td class="issue-path issue-link">
/DVWA/phpinfo.php
</td>
<td>Info</td>
<td class="nowrap">Tentative</td>
<td class="nowrap center no-print"><a href="#8162512688966804480">&gt;&gt;</a></td>
</tr>
</tbody>
</table>
</div>

<div class="section divider"></div>

<div class="section details">
<h1>More details for http://localhost</h1>
</div>

<div class="section details">
<div class="issue-container">
<a name="6662265378201060352"></a>
<h2>Cleartext submission of password</h2>
<a href="">/DVWA/login.php</a>

<h3>Issue detail:</h3>
<div>
The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost/DVWA/login.php</li></ul>The form contains the following password field:<ul><li>password</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/login.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=4kh3e4rh3lbv5u3vqdk2dbdmcb
Upgrade-Insecure-Requests: 1
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:31 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 1342
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;

		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;l<div class="snip"><span><span>Snip</span></span></div>&lt;div id=&quot;content&quot;&gt;

	<span class="highlight">&lt;form action=&quot;login.php&quot; method=&quot;post&quot;&gt;</span>

	&lt;fieldset&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;/label&gt; <span class="highlight">&lt;input type=&quot;password&quot; class=&quot;loginInput&quot; AUTOCOMPLETE=&quot;off&quot; size=&quot;20&quot; name=&quot;password&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="8273319290171446272"></a>
<h2>Cleartext submission of password</h2>
<a href="">/DVWA/vulnerabilities/brute/</a>

<h3>Issue detail:</h3>
<div>
The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost/DVWA/vulnerabilities/brute/</li></ul>The form contains the following password field:<ul><li>password</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">POST /DVWA/vulnerabilities/brute/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=fvpbil4rh4h6rrh2ap9r0q2c29
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/brute/
Content-Type: application/x-www-form-urlencoded
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 88

username=admin&amp;password=password&amp;Login=Login&amp;user_token=5b190419471c6dcad1294ce000915df2</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:24 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4449
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA)&lt;/ti<div class="snip"><span><span>Snip</span></span></div>&lt;/h2&gt;

		<span class="highlight">&lt;form action=&quot;#&quot; method=&quot;POST&quot;&gt;</span>
			Username:&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="3199837816772665344"></a>
<h2>Cleartext submission of password</h2>
<a href="">/DVWA/vulnerabilities/captcha/</a>

<h3>Issue detail:</h3>
<div>
The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost/DVWA/vulnerabilities/captcha/</li></ul>The form contains the following password fields:<ul><li>password_current</li><li>password_new</li><li>password_conf</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/captcha/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=g1q4ggqh26gm9bork71t4nfj11
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:16:50 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5003
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<div class="snip"><span><span>Snip</span></span></div>&lt;div class=&quot;vulnerable_code_area&quot;&gt;
		<span class="highlight">&lt;form action=&quot;#&quot; method=&quot;POST&quot; style=&quot;display:none;&quot;&gt;</span>
			&lt;h3&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_current&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_new&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_conf&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="9219153304335241216"></a>
<h2>Cleartext submission of password</h2>
<a href="">/DVWA/vulnerabilities/csrf/</a>

<h3>Issue detail:</h3>
<div>
The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost/DVWA/vulnerabilities/csrf/</li></ul>The form contains the following password fields:<ul><li>password_current</li><li>password_new</li><li>password_conf</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/csrf/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=fakf51rb1et8h6r3b4t7bcucuk
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:16:48 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5655
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
		<span class="highlight">&lt;form action=&quot;#&quot; method=&quot;GET&quot;&gt;</span>
			Current password:&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_current&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_new&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_conf&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="6632941044297651200"></a>
<h2>Cross-site scripting (DOM-based)</h2>
<a href="">/DVWA/vulnerabilities/xss_d/</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>document.location.href</b> and passed to <b>document.write()</b>.
</div>

<h3>
Issue background
</h3>
<div>
<p>DOM-based vulnerabilities arise when a client-side script reads data from a controllable part of the DOM (for example, the URL) and processes this data in an unsafe way.</p>
<p>DOM-based cross-site scripting arises when a script  writes controllable data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL that, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities.</p>

<p>Burp Suite automatically identifies this issue using dynamic and static code analysis. Static analysis can lead to false positives that are not actually exploitable. If Burp Scanner has not provided any evidence resulting from dynamic analysis, you should review the relevant code and execution paths  to determine whether this vulnerability is indeed present, or whether mitigations are in place that would prevent exploitation.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data from any untrusted source into the HTML document. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence. </p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">Web Security Academy: DOM-based cross-site scripting</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/588.html">CAPEC-588: DOM-Based XSS</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/xss_d/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=baf2oqemk2skmbn5pg7438bf8a
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:16:54 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4709
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<div class="snip"><span><span>Snip</span></span></div>&lt;script&gt;
					if (document.location.href.indexOf(&quot;default=&quot;) &gt;= 0) {
						<span class="highlight">var lang = document.location.href.substring(document.location.href.indexOf(&quot;default=&quot;)+8);</span>
						<span class="highlight">document.write(&quot;&lt;option value=&#39;&quot; + lang + &quot;&#39;&gt;&quot; + (lang) + &quot;&lt;/option&gt;&quot;);</span>
						document.write(&quot;&lt;option value=&#39;&#39; disabled=&#39;disabled&#39;&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/xss_d/?default=Spanish HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=a7cd57b6tfsgcrmo4eedde0jtk
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/xss_d/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:35 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4709
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Static analysis:</h3>
<div class="evidence-description">
<p>
Data is read from <b class="source-caption">document.location.href</b> and passed to <b class ="sink-caption">document.write()</b>
via the following statements:
</p>
<ul class="code-snippets">
<li>var lang = document.location.href.substring(document.location.href.indexOf("default=")+8);</li><li>document.write("&lt;option value='" + lang + "'&gt;" + (lang) + "&lt;/option&gt;");</li>
</ul>
</div>
<h3>Dynamic analysis:</h3>
<div>
<p>
Data is read from <b>location.href</b> and passed to <b>document.write</b>.
</p>
<ul>
<li>
<p>The following value was injected into the source:</p>
<pre class="code">http://localhost/DVWA/vulnerabilities/xss_d/?default=hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;Spanish#hs695asnjt=hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;</pre>
</li>

<li>
<p>The previous value reached the sink:</p>
<pre class="code">&lt;option value='hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;Spanish#hs695asnjt=hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;'&gt;hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;Spanish#hs695asnjt=hs695asnjt%27%22`'"/hs695asnjt/&gt;&lt;hs695asnjt/\&gt;a2o010jcna&amp;&lt;/option&gt;</pre>
</li>

<li>
<p>The stack trace at source was:</p>
<pre class="code">at Object._0x5ed253 [as proxiedGetterCallback] (&lt;anonymous&gt;:1:625634)
at get href [as href] (&lt;anonymous&gt;:1:323401)
at http://localhost/DVWA/vulnerabilities/xss_d/?default=Spanish:71:36</pre>
</li>

<li>
<p>The stack trace at the sink was:</p>
<pre class="code">at Object.WRdsg (&lt;anonymous&gt;:1:184730)
at Object.gmOtj (&lt;anonymous&gt;:1:612095)
at _0x2f9cd6 (&lt;anonymous&gt;:1:627659)
at Object.CnXbN (&lt;anonymous&gt;:1:178770)
at Object.DdSWw (&lt;anonymous&gt;:1:505640)
at Object.zlaZI (&lt;anonymous&gt;:1:529960)
at Object.KtjLN (&lt;anonymous&gt;:1:531450)
at HTMLDocument.write (&lt;anonymous&gt;:1:532580)
at http://localhost/DVWA/vulnerabilities/xss_d/?default=Spanish:72:16</pre>
</li>

<li>
<p>The following proof of concept was generated for this issue:</p>
<pre class="code">http://localhost/DVWA/vulnerabilities/xss_d/?default='"/onmouseover=alert(1)//Spanish#'"/onmouseover=alert(1)//</pre>
</li>
</ul>
</div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="2639630762444047360"></a>
<h2>Cross-site scripting (reflected)</h2>
<a href="">/DVWA/vulnerabilities/captcha/</a>

<h3>Issue detail:</h3>
<div>
The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>oi3ru'&gt;&lt;script&gt;alert(1)&lt;/script&gt;tbigkass8c2</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.
</div>

<h3>
Issue background
</h3>
<div>
<p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/captcha/?step=1&amp;password_current=password&amp;password_new=password&amp;password_conf=password&amp;user_token=bf7b3c60cdb5f08539de952f1960fbb6&amp;Change=Change HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible<span class="highlight">oi3ru&#39;%3e%3cscript%3ealert(1)%3c%2fscript%3etbigkass8c2</span>; PHPSESSID=dr7kvthpkkaa4n5he3nuv7i9mp
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/captcha/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:30:38 GMT
Server: Apache/2.4.57 (Debian)
Set-Cookie: security=impossible; path=/; HttpOnly
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5089
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<div class="snip"><span><span>Snip</span></span></div>&lt;input type=&quot;button&quot; value=&quot;View Help&quot; class=&quot;popup_button&quot; id=&#39;help_button&#39; data-help-url=&#39;../../vulnerabilities/view_help.php?id=captcha&amp;security=impossible<span class="highlight">oi3ru&#39;&gt;&lt;script&gt;alert(1)&lt;/script&gt;tbigkass8c2</span>&amp;locale=en&#39; )&quot;&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="3436743729126238208"></a>
<h2>Session token in URL</h2>
<a href="">/DVWA/vulnerabilities/csrf/</a>

<h3>Issue detail:</h3>
<div>
The URL in the request appears to contain a session token within the query string:<ul><li>http://localhost/DVWA/vulnerabilities/csrf/?password_current=password&amp;password_new=password&amp;password_conf=password&amp;Change=Change&amp;user_token=de0d377081dad769a4a283a04c5c7fc4</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing session tokens into the URL increases the risk that they will be captured by an attacker.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/593.html">CAPEC-593: Session Hijacking</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/csrf/?password_current=password&amp;password_new=password&amp;password_conf=password&amp;Change=Change&amp;user_token=<span class="highlight">de0d377081dad769a4a283a04c5c7fc4</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=3e2rsmae61nndharf0fu90hbkb
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/csrf/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:26 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5683
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="1428459683784560640"></a>
<h2>Session token in URL</h2>
<a href="">/DVWA/vulnerabilities/sqli/</a>

<h3>Issue detail:</h3>
<div>
The URL in the request appears to contain a session token within the query string:<ul><li>http://localhost/DVWA/vulnerabilities/sqli/?id=326051&amp;Submit=Submit&amp;user_token=444ed7f96cf210719d75910721cc3292</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing session tokens into the URL increases the risk that they will be captured by an attacker.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/593.html">CAPEC-593: Session Hijacking</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/sqli/?id=326051&amp;Submit=Submit&amp;user_token=<span class="highlight">444ed7f96cf210719d75910721cc3292</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=rkr6sgaek2am2tm06gh0puc5c0
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/sqli/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:16 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4255
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA)&lt;/<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="7004884733245221888"></a>
<h2>Session token in URL</h2>
<a href="">/DVWA/vulnerabilities/sqli_blind/</a>

<h3>Issue detail:</h3>
<div>
The URL in the request appears to contain a session token within the query string:<ul><li>http://localhost/DVWA/vulnerabilities/sqli_blind/?id=161320&amp;Submit=Submit&amp;user_token=373930fc1d39f1662ad7d57f5cae2e50</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing session tokens into the URL increases the risk that they will be captured by an attacker.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/593.html">CAPEC-593: Session Hijacking</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/sqli_blind/?id=161320&amp;Submit=Submit&amp;user_token=<span class="highlight">373930fc1d39f1662ad7d57f5cae2e50</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=99dvg454099v00klp7iuhq5141
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/sqli_blind/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 404 Not Found
Date: Thu, 16 Nov 2023 23:19:18 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Content-Length: 4370
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="4462581235335974912"></a>
<h2>Session token in URL</h2>
<a href="">/DVWA/vulnerabilities/xss_r/</a>

<h3>Issue detail:</h3>
<div>
The URL in the request appears to contain a session token within the query string:<ul><li>http://localhost/DVWA/vulnerabilities/xss_r/?name=tbhBBPKt&amp;user_token=1f5a9650aaeff0edf864a1e1927368e2</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing session tokens into the URL increases the risk that they will be captured by an attacker.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/593.html">CAPEC-593: Session Hijacking</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/xss_r/?name=tbhBBPKt&amp;user_token=<span class="highlight">1f5a9650aaeff0edf864a1e1927368e2</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=18i12jgkq2veutuscueko08hon
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/xss_r/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:20 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4432
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="4495901298508497920"></a>
<h2>Unencrypted communications</h2>
<a href="">/</a>

<h3>
Issue description
</h3>
<div>
<p>The application allows users to connect to it over unencrypted connections.  An attacker suitably positioned to view a legitimate user's network traffic could record and monitor their interactions with the application and obtain any information the user supplies. Furthermore, an attacker able to modify traffic could use the application as a platform for attacks against its users and third-party websites. Unencrypted connections have been exploited by ISPs and governments to track users, and to inject adverts and malicious JavaScript. Due to these concerns, web browser vendors are planning to visually flag unencrypted connections as hazardous.</p>
<p>
To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.
</p>
<p>Please note that using a mixture of encrypted and unencrypted communications is an ineffective defense against active attackers, because they can easily remove references to encrypted resources when these references are transmitted over an unencrypted connection.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should use transport-level encryption (SSL/TLS) to protect all communications passing between the client and the server. The Strict-Transport-Security HTTP header should be used to ensure that clients refuse to access the server over an insecure connection.</p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
<li><a href="https://www.chromium.org/Home/chromium-security/marking-http-as-non-secure">Marking HTTP as non-secure</a></li>
<li><a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Configuring Server-Side SSL/TLS</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security">HTTP Strict Transport Security</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/94.html">CAPEC-94: Man in the Middle Attack</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/157.html">CAPEC-157: Sniffing Attacks</a></li>
</ul>
</div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="5175234955310882816"></a>
<h2>Password submitted using GET method</h2>
<a href="">/DVWA/vulnerabilities/csrf/</a>

<h3>Issue detail:</h3>
<div>
The page contains a form with the following action URL, which is submitted using the GET method:<ul><li>http://localhost/DVWA/vulnerabilities/csrf/?password_current=password&amp;password_new=password&amp;password_conf=password&amp;Change=Change&amp;user_token=de0d377081dad769a4a283a04c5c7fc4</li></ul>The form contains the following password fields:<ul><li>password_current</li><li>password_new</li><li>password_conf</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>Some applications use the GET method to submit passwords, which are transmitted within the query string of the requested URL. Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing passwords into the URL increases the risk that they will be captured by an attacker.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>All forms submitting passwords should use the POST method. To achieve this, applications should specify the method attribute of the FORM tag as <b>method="POST"</b>. It may also be necessary to modify the corresponding server-side form handler to ensure that submitted passwords are properly retrieved from the message body, rather than the URL.
</p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/vulnerabilities/csrf/?password_current=password&amp;password_new=password&amp;password_conf=password&amp;Change=Change&amp;user_token=de0d377081dad769a4a283a04c5c7fc4 HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=3e2rsmae61nndharf0fu90hbkb
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/csrf/
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:26 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5683
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
		<span class="highlight">&lt;form action=&quot;#&quot; method=&quot;GET&quot;&gt;</span>
			Current password:&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_current&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_new&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input type=&quot;password&quot; AUTOCOMPLETE=&quot;off&quot; name=&quot;password_conf&quot;&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="530462010373129216"></a>
<h2>Input returned in response (reflected)</h2>
<a href="">/DVWA/phpinfo.php</a>

<h3>Issue detail:</h3>
<div>
The value of the <b>security</b> cookie is copied into the application's response.
</div>

<h3>
Issue background
</h3>
<div>
<p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">GET /DVWA/phpinfo.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible<span class="highlight">yknbyw82ln</span>; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:23:14 GMT
Server: Apache/2.4.57 (Debian)
Set-Cookie: security=impossible; path=/; HttpOnly
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 80722
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
body {background-color: #fff; co<div class="snip"><span><span>Snip</span></span></div>&lt;td class=&quot;v&quot;&gt;security=impossible<span class="highlight">yknbyw82ln</span>; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg &lt;/td&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;td class=&quot;v&quot;&gt;security=impossible<span class="highlight">yknbyw82ln</span>; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg &lt;/td&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;td class=&quot;v&quot;&gt;impossible<span class="highlight">yknbyw82ln</span>&lt;/td&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;td class=&quot;v&quot;&gt;security=impossible<span class="highlight">yknbyw82ln</span>; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg&lt;/td&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="8583106390470191104"></a>
<h2>Input returned in response (reflected)</h2>
<a href="">/DVWA/vulnerabilities/captcha/</a>

<h3>Issue detail:</h3>
<div>
The value of the <b>security</b> cookie is copied into the application's response.
</div>

<h3>
Issue background
</h3>
<div>
<p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">POST /DVWA/vulnerabilities/captcha/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible<span class="highlight">2npzfit8iu</span>; PHPSESSID=dr7kvthpkkaa4n5he3nuv7i9mp
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/captcha/
Content-Type: application/x-www-form-urlencoded
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 135

step=1&amp;password_current=password&amp;password_new=password&amp;password_conf=password&amp;user_token=66f59af4292d486539b697c98223daef&amp;Change=Change</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:30:25 GMT
Server: Apache/2.4.57 (Debian)
Set-Cookie: security=impossible; path=/; HttpOnly
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5023
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<div class="snip"><span><span>Snip</span></span></div>&lt;input type=&quot;button&quot; value=&quot;View Help&quot; class=&quot;popup_button&quot; id=&#39;help_button&#39; data-help-url=&#39;../../vulnerabilities/view_help.php?id=captcha&amp;security=impossible<span class="highlight">2npzfit8iu</span>&amp;locale=en&#39; )&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;View Source&quot; class=&quot;popup_button&quot; id=&#39;source_button&#39; data-source-url=&#39;../../vulnerabilities/view_source.php?id=captcha&amp;security=impossible<span class="highlight">2npzfit8iu</span>&#39; )&quot;&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="2553727121472761856"></a>
<h2>Cross-domain Referer leakage</h2>
<a href="">/DVWA/instructions.php</a>

<h3>Issue detail:</h3>
<div>
The application contains links to the following other domains from URLs containing a query string:<ul><li>127.0.0.1</li><li>contrib.rocks</li><li>hiderefer.com</li><li>docs.docker.com</li><li>en.wikipedia.org</li><li>github.com</li><li>www.dvwa.co.uk</li><li>mariadb.com</li><li>nvd.nist.gov</li><li>secure.php.net</li><li>www.apachefriends.org</li><li>www.docker.com</li><li>www.gnu.org</li><li>www.google.com</li><li>www.howtogeek.com</li><li>www.php.net</li><li>www.ryadel.com</li><li>www.virtualbox.org</li><li>www.vmware.com</li><li>www.youtube.com</li></ul>Numerous links to other domains were found and the above are a sample subset.<br><br>This issue was found in multiple locations under the reported path.
</div>

<h3>
Issue background
</h3>
<div>
<p>When a web browser makes a request for a resource, it typically adds an HTTP header, called the "Referer" header, indicating the URL of the resource from which the request originated. This occurs in numerous situations, for example when a web page loads an image or script, or when a user clicks on a link or submits a form.</p>
<p>If the resource being requested resides on a different domain, then the Referer header is still generally included in the cross-domain request. If the originating URL contains any sensitive information within its query string, such as a session token, then this information will be transmitted to the other domain. If the other domain is not fully trusted by the application, then this may lead to a security compromise.</p>
<p>You should review the contents of the information being transmitted to other domains, and also determine whether those domains are fully trusted by the originating application.</p>
<p>Today's browsers may withhold the Referer header in some situations (for example, when loading a non-HTTPS resource from a page that was loaded over HTTPS, or when a Refresh directive is issued), but this behavior should not be relied upon to protect the originating URL from disclosure.</p>
<p>Note also that if users can author content within the application then an attacker may be able to inject links referring to a domain they control in order to capture data from URLs used within the application. </p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Applications should never transmit any sensitive information within the URL query string. In addition to being leaked in the Referer header, such information may be logged in various locations and may be visible on-screen to untrusted parties. If placing sensitive information in the URL is unavoidable, consider using the Referer-Policy HTTP header to reduce the chance of it being disclosed to third parties.
</p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">Referer Policy</a></li>
    <li><a href="https://portswigger.net/web-security/information-disclosure">Web Security Academy: Information disclosure</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/instructions.php?doc=readme HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=4kh3e4rh3lbv5u3vqdk2dbdmcb
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/instructions.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:32 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 32465
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link <div class="snip"><span><span>Snip</span></span></div>&lt;p&gt;Login URL: <span class="highlight">&lt;a href=&quot;http://127.0.0.1/login.php&quot;&gt;</span>http://127.0.0.1/login.php&lt;/a&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:32 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 32465
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link <div class="snip"><span><span>Snip</span></span></div>&lt;a href=&quot;https://github.com/digininja/DVWA/graphs/contributors&quot;&gt;
  <span class="highlight">&lt;img src=&quot;https://contrib.rocks/image?repo=digininja/DVWA&amp;max=500&quot;&gt;</span>
&lt;/a&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET /DVWA/instructions.php?doc=changelog HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=04491020rjq4p0ns9hqinmlrcv
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/instructions.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:07 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 11249
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link <div class="snip"><span><span>Snip</span></span></div>&lt;li&gt;All links use <span class="highlight">&lt;a href=&quot;http://hiderefer.com&quot;&gt;</span>http://hiderefer.com&lt;/a&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="6513416475085334528"></a>
<h2>Cross-domain script include</h2>
<a href="">/DVWA/vulnerabilities/captcha/</a>

<h3>Issue detail:</h3>
<div>
The response dynamically includes the following script from another domain:<ul><li>https://www.google.com/recaptcha/api.js</li></ul>
</div>

<h3>
Issue background
</h3>
<div>
<p>When an application includes a script from an external domain, this script is executed by the browser within the security context of the invoking application. The script can therefore do anything that the application's own scripts can do, such as accessing application data and performing actions within the context of the current user.</p>
<p>If you include a script from an external domain, then you are trusting that domain with the data and functionality of your application, and you are trusting the domain's own security to prevent an attacker from modifying the script to perform malicious actions within your application. </p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>Scripts should ideally not be included from untrusted domains. Applications that rely on static third-party scripts should consider using Subresource Integrity to make browsers verify them, or copying the contents of these scripts onto their own domain and including them from there. If that is not possible (e.g. for licensing reasons) then consider reimplementing the script's functionality within application code.</p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
<li>
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity</a>
</li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/829.html">CWE-829: Inclusion of Functionality from Untrusted Control Sphere</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">POST /DVWA/vulnerabilities/captcha/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=rirqd0ni6091ombi6d8bj4jvql
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/captcha/
Content-Type: application/x-www-form-urlencoded
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 135

step=1&amp;password_current=password&amp;password_new=password&amp;password_conf=password&amp;user_token=0065d1759eb430420cdeab9bd4a8dd26&amp;Change=Change</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:31 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5003
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;

			
		<span class="highlight">&lt;script src=&#39;https://www.google.com/recaptcha/api.js&#39;&gt;</span>&lt;/script&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="9061096486082190336"></a>
<h2>Cookie without HttpOnly flag set</h2>
<a href="">/DVWA/security.php</a>

<h3>Issue detail:</h3>
<div>
The following cookie was issued by the application and does not have the HttpOnly flag set:<ul><li>security</li></ul>The cookie does not appear to contain a session token, which may reduce the risk associated with this issue. You should review the contents of the cookie to determine its function.
</div>

<h3>
Issue background
</h3>
<div>
<p>If the HttpOnly attribute is set on a cookie, then the cookie's value cannot be read or set by client-side JavaScript. This measure makes certain client-side attacks, such as cross-site scripting, slightly harder to exploit by preventing them from trivially capturing the cookie's value via an injected script.</p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>There is usually no good reason not to set the HttpOnly flag on all cookies. Unless you specifically require legitimate client-side scripts within your application to read or set a cookie's value, you should set the HttpOnly flag by including this attribute within the relevant Set-cookie directive.</p>
<p>You should be aware that the restrictions imposed by the HttpOnly flag can potentially be circumvented in some circumstances, and that numerous other serious attacks can be delivered by client-side script injection, aside from simple cookie stealing. </p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
<li><a href='https://portswigger.net/web-security/cross-site-scripting/exploiting'>Web Security Academy: Exploiting XSS vulnerabilities</a></li>
<li><a href='https://portswigger.net/research/web-storage-the-lesser-evil-for-session-tokens#httponly'>HttpOnly effectiveness</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/31.html">CAPEC-31: Accessing/Intercepting/Modifying HTTP Cookies</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">POST /DVWA/security.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=hkqa8asvqjbsloem977or9fah9
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/security.php
Content-Type: application/x-www-form-urlencoded
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 80

security=medium&amp;seclev_submit=Submit&amp;user_token=8d4b3c7e14eb1d7e00e86558d7681b98</div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 302 Found
Date: Thu, 16 Nov 2023 23:19:22 GMT
Server: Apache/2.4.57 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
<span class="highlight">Set-Cookie: security=medium; path=/</span>
Location: /DVWA/security.php
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8

</div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="698793763940194304"></a>
<h2>File upload functionality</h2>
<a href="">/DVWA/vulnerabilities/upload/</a>

<h3>Issue detail:</h3>
<div>
The page contains a form which is used to submit a user-supplied file to the following URL:<ul><li>http://localhost/DVWA/vulnerabilities/upload/</li></ul>Note that Burp has not identified any specific security vulnerabilities with this functionality, and you should manually review it to determine whether any problems exist.
</div>

<h3>
Issue background
</h3>
<div>
<p>File upload functionality is commonly associated with a number of vulnerabilities, including:</p>
<ul>
<li>File path traversal</li><li>Persistent cross-site scripting</li><li>Placing of other client-executable code into the domain</li><li>Transmission of viruses and other malware</li><li>Denial of service</li></ul>
<p>You should review file upload functionality to understand its purpose, and establish whether uploaded content is ever returned to other application users, either through their normal usage of the application or by being fed a specific link by an attacker.</p>
<p>Some factors to consider when evaluating the security impact of this functionality include:</p>
<ul>
<li>Whether uploaded content can subsequently be downloaded via a URL within the application.</li><li>What Content-type and Content-disposition headers the application returns when the file's content is downloaded.</li><li>Whether it is possible to place executable HTML/JavaScript into the file, which executes when the file's contents are viewed.</li><li>Whether the application performs any filtering on the file extension or MIME type of the uploaded file.</li><li>Whether it is possible to construct a hybrid file containing both executable and non-executable content, to bypass any content filters - for example, a file containing both a GIF image and a Java archive (known as a GIFAR file).</li><li>What location is used to store uploaded content, and whether it is possible to supply a crafted filename to escape from this location.</li><li>Whether archive formats such as ZIP are unpacked by the application.</li><li>How the application handles attempts to upload very large files, or decompression bomb files.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>File upload functionality is not straightforward to implement securely. Some recommendations to consider in the design of this functionality include:</p>
<ul>
<li>Use a server-generated filename if storing uploaded files on disk.</li><li>Inspect the content of uploaded files, and enforce a whitelist of accepted, non-executable content types. Additionally, enforce a blacklist of common executable formats, to hinder hybrid file attacks.</li><li>Enforce a whitelist of accepted, non-executable file extensions.</li>
<li>If uploaded files are downloaded by users, supply an accurate non-generic Content-Type header, the X-Content-Type-Options: nosniff header, and also a Content-Disposition header that specifies that browsers should handle the file as an attachment.</li>
<li>Enforce a size limit on uploaded files (for defense-in-depth, this can be implemented both within application code and in the web server's configuration).</li><li>Reject attempts to upload archive formats such as ZIP.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://github.com/cure53/H5SC/tree/master/attachments">Various proof-of-concept files</a></li>
<li><a href="http://labs.detectify.com/post/120088174539/building-an-xss-polyglot-through-swf-and-csp">An XSS polyglot attack</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434: Unrestricted Upload of File with Dangerous Type</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/17.html">CAPEC-17: Using Malicious Files</a></li>
</ul>
</div>

<h3>Request:</h3>
<div class="request-response">POST /DVWA/vulnerabilities/upload/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=h34vtb2747su2rvlhgbv1qt88t
Origin: http://localhost
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/vulnerabilities/upload/
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBeaFSXYhiQ1Q5mAj
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 530

------WebKitFormBoundaryBeaFSXYhiQ1Q5mAj
Content-Disposition: form-data; name=&quot;MAX_FILE_SIZE&quot;

100000
------WebKitFormBoundaryBeaFSXYhiQ1Q5mAj
Content-Disposition: form-data; name=&quot;uploaded&quot;; fil<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Response:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:30 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 4457
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA)&lt;/ti<div class="snip"><span><span>Snip</span></span></div>&lt;br /&gt;
			<span class="highlight">&lt;input name=&quot;uploaded&quot; type=&quot;file&quot; /&gt;</span>&lt;br /&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="844732300998313984"></a>
<h2>Path-relative style sheet import</h2>
<a href="">/DVWA/</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.
</div>

<h3>
Issue background
</h3>
<div>
<p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=dpvb19t3no3n7joffv5i7dt1a8
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:40 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6016
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/<span class="highlight">index.php/epeg4m/</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=dpvb19t3no3n7joffv5i7dt1a8
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:13 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6016
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET <span class="highlight">/DVWA/index.php/epeg4m/dvwa/css/main.css</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=dpvb19t3no3n7joffv5i7dt1a8
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:13 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6016
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="1579841131381371904"></a>
<h2>Path-relative style sheet import</h2>
<a href="">/DVWA/about.php</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.
</div>

<h3>
Issue background
</h3>
<div>
<p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/about.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=mo3vlcje1jgmh81i7omi2gilb3
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:06 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5284
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/about.php<span class="highlight">/ydh1ox/</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=mo3vlcje1jgmh81i7omi2gilb3
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:17 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5284
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET <span class="highlight">/DVWA/about.php/ydh1ox/dvwa/css/main.css</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=mo3vlcje1jgmh81i7omi2gilb3
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:17 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5284
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;st<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="4802661808791532544"></a>
<h2>Path-relative style sheet import</h2>
<a href="">/DVWA/index.php</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.
</div>

<h3>
Issue background
</h3>
<div>
<p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/index.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=37all763lhito7ukvcnsir9ktu
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/login.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:59 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6103
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/index.php<span class="highlight">/f4mrt5/</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=eqa8v0vkb9um1qd6nmh7s2r7no
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/login.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:16 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6103
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET <span class="highlight">/DVWA/index.php/f4mrt5/dvwa/css/main.css</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=c92ovddmq4qm444iklqko17t6h
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/login.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:16 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6103
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;<div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="9097519369040133120"></a>
<h2>Path-relative style sheet import</h2>
<a href="">/DVWA/instructions.php</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.
</div>

<h3>
Issue background
</h3>
<div>
<p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/instructions.php?doc=readme HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=ihgpipvns3sf8tm4tdirl4k55j
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/instructions.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:45 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 32465
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/instructions.php<span class="highlight">/nmxbvn/</span>?doc=readme HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=ihgpipvns3sf8tm4tdirl4k55j
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/instructions.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:13 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 32465
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/main.css&quot; /&gt;</span>

		&lt;link rel=&quot;icon&quot; type=&quot;\image/ico&quot; href=&quot;favicon.ico&quot; /&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET <span class="highlight">/DVWA/instructions.php/nmxbvn/dvwa/css/main.css</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=ihgpipvns3sf8tm4tdirl4k55j
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/instructions.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:20:13 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 32465
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link <div class="snip"><span><span>Snip</span></span></div></div>

</div><div class="issue-container">
<a name="7585101238261731328"></a>
<h2>Path-relative style sheet import</h2>
<a href="">/DVWA/login.php</a>

<h3>Issue detail:</h3>
<div>
The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.
</div>

<h3>
Issue background
</h3>
<div>
<p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/login.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=16lop5ok33g9roti6iea817cko
Upgrade-Insecure-Requests: 1
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:23:25 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 1342
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;

		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/login.css&quot; /&gt;</span>

	&lt;/head&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/login.php<span class="highlight">/rd7y23/</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=kdfvrblmuh5ma2j34htl6bkbl7
Upgrade-Insecure-Requests: 1
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:28 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 1342
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;

		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		<span class="highlight">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;dvwa/css/login.css&quot; /&gt;</span>

	&lt;/head&gt;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET <span class="highlight">/DVWA/login.php/rd7y23/dvwa/css/login.css</span> HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=ktoad322ae363tt6o6kl06irk0
Upgrade-Insecure-Requests: 1
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:28 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 1342
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;

		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;l<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="3194368389396474880"></a>
<h2>Frameable response (potential Clickjacking)</h2>
<a href="">/DVWA</a>

<h3>Issue detail:</h3>
<div>
This issue was found in multiple locations under the reported path.
</div>

<h3>
Issue background
</h3>
<div>
<p>If a page fails to set an appropriate X-Frame-Options or Content-Security-Policy HTTP header, it might be possible for a page controlled by an attacker to load it within an iframe. This may enable a clickjacking attack, in which the attacker's page overlays the target application's interface with a different interface provided by the attacker. By inducing victim users to perform actions such as mouse clicks and keystrokes, the attacker can cause them to unwittingly carry out actions within the application that is being targeted. This technique allows the attacker to circumvent defenses against cross-site request forgery, and may result in unauthorized actions.</p>
<p>Note that some applications attempt to prevent these attacks from within the HTML page itself, using "framebusting" code. However, this type of defense is normally ineffective and can usually be circumvented by a skilled attacker.</p>
<p>You should determine whether any functions accessible within frameable pages can be used by application users to perform any sensitive actions within the application. </p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>To effectively prevent framing attacks, the application should return a response header with the name <b>X-Frame-Options</b> and the value <b>DENY</b> to prevent framing altogether, or the value <b>SAMEORIGIN</b> to allow framing only by pages on the same origin as the response itself. Note that the SAMEORIGIN header can be partially bypassed if the application itself can be made to frame untrusted websites.</p>
</div>

<h3>References</h3>
<div class="no-bullets">
<ul>
    <li><a href="https://portswigger.net/web-security/clickjacking">Web Security Academy: Clickjacking</a></li>
    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options">X-Frame-Options</a></li>
</ul>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
    <li><a href="https://cwe.mitre.org/data/definitions/693.html">CWE-693: Protection Mechanism Failure</a></li>
    <li><a href="https://cwe.mitre.org/data/definitions/1021.html">CWE-1021: Improper Restriction of Rendered UI Layers or Frames</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/103.html">CAPEC-103: Clickjacking</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/ HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=m436nj4tpnkldmetr08t5psk6q
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:16:43 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6016
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/about.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=p8v8bklpkhpifo20nofomiuug9
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:17:02 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 5284
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;st<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 3:</h3>
<div class="request-response">GET /DVWA/index.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=4kh3e4rh3lbv5u3vqdk2dbdmcb
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/login.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

</div>
<h3>Response 3:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:19:31 GMT
Server: Apache/2.4.57 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: 6103
Connection: close
Content-Type: text/html;charset=utf-8

&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en-GB&quot;&gt;

	&lt;head&gt;
		&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;

		&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA)&lt;/title&gt;

		&lt;link rel=&quot;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="1617911168488937472"></a>
<h2>Spoofable client IP address</h2>
<a href="">/DVWA/phpinfo.php</a>

<h3>
Issue description
</h3>
<div>
<p>
If an application trusts an HTTP request header like X-Forwarded-For to accurately specify the remote IP address of the connecting client, then malicious clients can spoof their IP address. This behavior does not necessarily constitute a security vulnerability, however some applications use client IP addresses to enforce access controls and rate limits. For example, an application might expose administrative functionality only to clients connecting from the local IP address of the server, or allow a certain number of failed login attempts from each unique IP address.
Consider reviewing relevant functionality to determine whether this might be the case. </p>
</div>

<h3>
Issue remediation
</h3>
<div>
<p>HTTP request headers such as X-Forwarded-For, True-Client-IP, and X-Real-IP are not a robust foundation on which to build any security measures, such as access controls. Any such measures should be replaced with more secure alternatives that are not vulnerable to spoofing.</p>
<p>If the platform application server returns incorrect information about the client's IP address due to the presence of any particular HTTP request header, then the server may need to be reconfigured, or an alternative method of identifying clients should be used. </p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/phpinfo.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:24 GMT
Server: Apache/2.4.57 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: <span class="highlight">80571</span>
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
body {background-color: #fff; co<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/phpinfo.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0
<span class="highlight">X-Forwarded-For: 127.0.0.1</span>

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:24 GMT
Server: Apache/2.4.57 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: <span class="highlight">80813</span>
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
body {background-color: #fff; co<div class="snip"><span><span>Snip</span></span></div>&lt;td class=&quot;v&quot;&gt;/var/www/html <span class="highlight">&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;REQUEST_SCHEME &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;http &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;CONTEXT_PREFIX &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;</span>&lt;i&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;/th&gt;<span class="highlight">&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;HTTP Request &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;GET /DVWA/phpinfo.php HTTP/1.1 &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Host &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;localhost &lt;/td&gt;</span>&lt;/tr&gt;<div class="snip"><span><span>Snip</span></span></div>&lt;/th&gt;<span class="highlight">&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;$_COOKIE[&#39;security&#39;]&lt;/td&gt;&lt;td class=&quot;v&quot;&gt;impossible&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;$_COOKIE[&#39;PHPSESSID&#39;]&lt;/td&gt;&lt;td class=&quot;v&quot;&gt;g09k9f4fpepd6rnhvuucgh19lg&lt;/td&gt;</span>&lt;/tr&gt;<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div><div class="section details">
<div class="issue-container">
<a name="8162512688966804480"></a>
<h2>User agent-dependent response</h2>
<a href="">/DVWA/phpinfo.php</a>

<h3>
Issue description
</h3>
<div>
<p>Application responses may depend systematically on the value of the User-Agent header in requests. This behavior does not itself constitute a security vulnerability, but may point towards additional attack surface within the application, which may contain vulnerabilities.</p>
<p>This behavior often arises because applications provide different user interfaces for desktop and mobile users. Mobile interfaces have often been less thoroughly tested for vulnerabilities such as cross-site scripting, and often have simpler authentication and session handling mechanisms that may contain problems that are not present in the full interface.</p>
<p>To review the interface provided by the alternate User-Agent header, you can configure a match/replace rule in Burp Proxy to modify the User-Agent header in all requests, and then browse the application in the normal way using your normal browser. </p>
</div>

<h3>Vulnerability classifications</h3>
<div class="no-bullets">
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul>
</div>

<h3>Request 1:</h3>
<div class="request-response">GET /DVWA/phpinfo.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
<span class="highlight">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36</span>
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 1:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:24 GMT
Server: Apache/2.4.57 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: <span class="highlight">80571</span>
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
body {background-color: #fff; co<div class="snip"><span><span>Snip</span></span></div></div>
<h3>Request 2:</h3>
<div class="request-response">GET /DVWA/phpinfo.php HTTP/1.1
Host: localhost
Accept-Encoding: gzip, deflate, br
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
<span class="highlight">User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3</span>
Connection: close
Cache-Control: max-age=0
Cookie: security=impossible; PHPSESSID=g09k9f4fpepd6rnhvuucgh19lg
Upgrade-Insecure-Requests: 1
Referer: http://localhost/DVWA/index.php
Sec-CH-UA: &quot;.Not/A)Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;119&quot;, &quot;Chromium&quot;;v=&quot;119&quot;
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
Content-Length: 0

</div>
<h3>Response 2:</h3>
<div class="request-response">HTTP/1.1 200 OK
Date: Thu, 16 Nov 2023 23:26:24 GMT
Server: Apache/2.4.57 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Vary: Accept-Encoding
Content-Length: <span class="highlight">80625</span>
Connection: close
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;
body {background-color: #fff; co<div class="snip"><span><span>Snip</span></span></div></div>

</div>
</div>

<div class="section divider"></div>

</div>
</body>
</html>